<?xml version="1.0" encoding="UTF-8"?>
<FindBugsFilter>
    <!--
        SpotBugs exclusion filter for AE2 Autorequester
        Only exclude patterns that are genuinely false positives in Minecraft modding context.
        Keep this list minimal - fix issues rather than suppressing them.
    -->

    <!-- Exclude generated code (data generators, mixins) -->
    <Match>
        <Source name="~.*Generated.*\.java"/>
    </Match>

    <!-- Minecraft/NeoForge patterns that are intentional -->
    <Match>
        <!-- Registry objects are intentionally compared by reference -->
        <Bug pattern="ES_COMPARING_STRINGS_WITH_EQ"/>
        <Class name="~.*Registry.*"/>
    </Match>

    <!-- Serialization patterns in Minecraft -->
    <Match>
        <Bug pattern="SE_BAD_FIELD"/>
        <Class name="~.*Packet.*"/>
    </Match>

    <!-- Block entities often have intentional null field initialization -->
    <Match>
        <Bug pattern="UWF_UNWRITTEN_FIELD"/>
        <Class name="~.*BlockEntity"/>
    </Match>

    <!-- NeoForge config classes use public fields by design -->
    <Match>
        <Bug pattern="PA_PUBLIC_PRIMITIVE_ATTRIBUTE"/>
        <Class name="~.*Config"/>
    </Match>

    <!-- EMI plugin intentionally matches EMI's naming convention -->
    <Match>
        <Bug pattern="NM_SAME_SIMPLE_NAME_AS_INTERFACE"/>
        <Class name="~.*\.compat\.emi\.EmiPlugin"/>
    </Match>

    <!-- IPayloadContext.player() is annotated @Nonnull in NeoForge API -->
    <Match>
        <Bug pattern="RCN_REDUNDANT_NULLCHECK_OF_NONNULL_VALUE"/>
        <Class name="~.*Packet"/>
    </Match>

    <!--
        EI_EXPOSE_REP / EI_EXPOSE_REP2: Exposing internal representation

        FALSE POSITIVES in Minecraft modding context:
        - Item objects are registry singletons (effectively immutable)
        - BlockEntity references are required for menu/GUI integration
        - IGridNode and IStackWatcher are AE2 API callbacks (not our data)
        - SyncRulesPacket.rules() returns unmodifiable list (SpotBugs can't detect this)
    -->

    <!-- Item getters/setters - Item is a registry singleton, effectively immutable -->
    <Match>
        <Bug pattern="EI_EXPOSE_REP"/>
        <Or>
            <Method name="getItem"/>
            <Method name="getTargetItem"/>
        </Or>
    </Match>
    <Match>
        <Bug pattern="EI_EXPOSE_REP2"/>
        <Or>
            <Method name="setItem"/>
            <Method name="setTargetItem"/>
            <Method name="~.*&lt;init&gt;.*"/>
        </Or>
        <Or>
            <Class name="~.*CraftingCondition"/>
            <Class name="~.*CraftingRule"/>
        </Or>
    </Match>

    <!-- Internal AE2 integration - these are API callbacks, not our data -->
    <Match>
        <Bug pattern="EI_EXPOSE_REP"/>
        <Class name="~.*AutorequesterBlockEntity"/>
        <Method name="getMainNode"/>
    </Match>
    <Match>
        <Bug pattern="EI_EXPOSE_REP2"/>
        <Class name="~.*AutorequesterBlockEntity"/>
        <Method name="updateWatcher"/>
    </Match>

    <!-- Menu needs direct BlockEntity reference for GUI synchronization -->
    <Match>
        <Bug pattern="EI_EXPOSE_REP"/>
        <Class name="~.*Menu"/>
        <Method name="getBlockEntity"/>
    </Match>
    <Match>
        <Bug pattern="EI_EXPOSE_REP2"/>
        <Class name="~.*Menu"/>
    </Match>

    <!-- SyncRulesPacket returns unmodifiable list (SpotBugs can't detect this) -->
    <Match>
        <Bug pattern="EI_EXPOSE_REP"/>
        <Class name="~.*SyncRulesPacket"/>
    </Match>

    <!--
        Mutable collection accessors used for editing.
        These are intentionally mutable to support the editing workflow.
    -->
    <Match>
        <Bug pattern="EI_EXPOSE_REP"/>
        <Class name="~.*AutorequesterBlockEntity"/>
        <Method name="getRules"/>
    </Match>
    <Match>
        <Bug pattern="EI_EXPOSE_REP"/>
        <Class name="~.*CraftingRule"/>
        <Method name="getConditions"/>
    </Match>
</FindBugsFilter>
